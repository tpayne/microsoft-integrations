:root{
  /* Light theme (defaults) */
  --bg: #ffffff;
  --surface: #fbfcfd;
  --muted: #6b7280;
  --border: #e6e9ee;
  --text: #111827;
  --accent: #0f64ff;
  --success: #16a34a;
  --warn: #f59e0b;
  --danger: #ef4444;
  --radius: 10px;
  --gap: 12px;
  --pad: 14px;
  --shadow: 0 1px 2px rgba(16,24,40,0.04);
  color-scheme: light dark;
  font-size: 14px;
  line-height: 1.4;
  font-family: -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
  -webkit-font-smoothing:antialiased;
  -moz-osx-font-smoothing:grayscale;
}

/* Dark theme overrides */
@media (prefers-color-scheme: dark) {
  :root{
    --bg: #0b1220;
    --surface: #0f1724;
    --muted: #9ca3af;
    --border: #1f2937;
    --text: #e6edf3;
    --accent: #58a6ff;
    --success: #34d399;
    --warn: #fbbf24;
    --danger: #fb7185;
    --shadow: 0 1px 4px rgba(2,6,23,0.6);
  }
}

/* Apply variables to document */
*{box-sizing:border-box}

html,body{
  height:100%;
  margin:0;
  background:var(--bg);
  color:var(--text);
  padding:16px;
  transition:background .15s ease,color .15s ease;
}

/* Header / branding */
.header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  gap:var(--gap);
  margin-bottom:12px;
}
.brand{display:flex;align-items:center;gap:10px}
.logo{
  width:36px;height:36px;border-radius:8px;
  background:linear-gradient(135deg,var(--accent) 0%,#5aa8ff 100%);
  color:white;font-weight:700;display:flex;align-items:center;justify-content:center;
  font-size:14px;box-shadow:var(--shadow);
}
.title{font-size:15px;margin:0;font-weight:600}

/* Info button */
.infoBtn{
  background:transparent;border:1px solid var(--border);padding:6px;border-radius:8px;cursor:pointer;
  color:var(--text);
}
.infoBtn:focus{outline:3px solid rgba(15,100,255,0.18);}

/* Card */
.card{
  background:var(--surface);
  border:1px solid var(--border);
  border-radius:var(--radius);
  padding:var(--pad);
  margin-bottom:12px;
  box-shadow:var(--shadow);
}
.row{display:flex;justify-content:space-between;align-items:center;padding:6px 0}
.muted{color:var(--muted);font-weight:500;font-size:13px}

/* Urgency indicator */
.urgencyGroup{display:flex;align-items:center;gap:8px}
.urgency-indicator{
  display:inline-block;width:48px;height:10px;border-radius:999px;background:#cbd5e1;
  border:1px solid rgba(0,0,0,0.03);
}
.urgency-indicator.high{background:var(--danger)}
.urgency-indicator.medium{background:var(--warn)}
.urgency-indicator.low{background:var(--success)}
.urgency-indicator.unknown{background:#cfd8e3}

/* Actions */
.actions{display:flex;flex-direction:column;gap:8px}
button{font-weight:600;border-radius:8px;padding:8px 12px;border:1px solid transparent;cursor:pointer;color:var(--text)}
button.primary{background:var(--accent);color:white}
button.primary:hover{filter:brightness(.98)}
button.ghost{background:transparent;border:1px solid var(--border);color:var(--text)}
button:focus{outline:3px solid rgba(15,100,255,0.16);}

/* Response container */
/* Make response container consistent with .card */
.response{
  background: var(--surface);
  border: 1px solid var(--border);
  box-shadow: var(--shadow);
  border-radius: var(--radius);
  padding: var(--pad);
  min-height: 60px;
  white-space: pre-wrap;
  font-size: 13px;
  color: var(--text);
  transition: background .15s ease, color .15s ease, box-shadow .12s ease;
}


/* Small hint */
.hint{color:var(--muted);font-size:12px}

/* Utilities */
.hidden{display:none}

/* Responsive tweaks for narrow panes */
@media (max-width:360px){
  .logo{width:32px;height:32px;font-size:13px}
  :root{--pad:10px;--gap:8px}
  .response{min-height:48px}
}

/* Respect high contrast user settings */
@media (forced-colors: active) {
  *{forced-color-adjust: none}
  .logo{background:CanvasText;color:Canvas}
}

/* --- Chatbot Styles --- */
.chatbot-card {
  padding: 0; /* Remove padding from the card itself */
  margin-bottom: 12px;
}

.chat-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: var(--pad); /* Use card padding for the header */
  border-bottom: 1px solid var(--border);
  cursor: pointer;
}

/* Toggle button styling */
.toggle-button {
  all: unset; /* Remove all default button styles */
  cursor: pointer;
  padding: 4px; /* Make the click target larger */
}
.toggle-button:focus {
  outline: 3px solid var(--accent);
  opacity: 0.8;
  border-radius: 4px;
}

/* Arrow rotation for visual feedback */
.toggle-button[aria-expanded="true"] .arrow-down {
  transform: rotate(180deg);
}

.arrow-down {
  display: inline-block;
  transition: transform 0.2s ease-in-out;
  color: var(--text);
  font-size: 10px;
}

/* Chat content (collapsible) */
.chat-content {
  padding: var(--pad);
  border-top: 1px solid var(--border);
}

/* Chat history/log */
.chat-history {
  max-height: 200px; /* Limit history height */
  overflow-y: auto;
  margin-bottom: var(--gap);
  padding-right: 5px; /* Space for scrollbar */
}

/* Message bubble styles */
.message {
  margin-bottom: 8px;
  max-width: 85%;
  padding: 8px 12px;
  border-radius: var(--radius);
  font-size: 13px;
  line-height: 1.3;
}
.user-message {
  background-color: var(--accent);
  color: white;
  margin-left: auto;
  text-align: right;
  border-bottom-right-radius: 4px;
}
.ai-message {
  background-color: var(--border);
  color: var(--text);
  margin-right: auto;
  border-bottom-left-radius: 4px;
}
/* Ensure dark theme contrast for AI messages */
html[data-theme='dark'] .ai-message {
  background-color: var(--surface);
}

/* Chat input area */
.chat-input-area {
  display: flex;
  gap: var(--gap);
}
#chatInput {
  flex-grow: 1;
  padding: 8px;
  border: 1px solid var(--border);
  border-radius: var(--radius);
  background: var(--surface);
  color: var(--text);
}
#chatInput:focus {
  outline: 2px solid var(--accent);
}
#chatSendBtn {
  flex-shrink: 0;
}